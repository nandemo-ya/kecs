{
  "family": "background-worker",
  "networkMode": "bridge",
  "requiresCompatibilities": ["EC2"],
  "cpu": "256",
  "memory": "512",
  "containerDefinitions": [
    {
      "name": "worker",
      "image": "python:3.9-alpine",
      "cpu": 256,
      "memory": 512,
      "essential": true,
      "command": [
        "sh",
        "-c",
        "echo 'import time\nimport os\nimport sys\n\nprint(\"Worker started\", flush=True)\nqueue_name = os.environ.get(\"QUEUE_NAME\", \"default-queue\")\nprocessing_interval = int(os.environ.get(\"PROCESSING_INTERVAL\", \"5\"))\n\nwhile True:\n    print(f\"Processing queue: {queue_name}\", flush=True)\n    time.sleep(processing_interval)\n    print(f\"Processed item from {queue_name}\", flush=True)' > worker.py && python -u worker.py"
      ],
      "environment": [
        {
          "name": "QUEUE_NAME",
          "value": "test-queue"
        },
        {
          "name": "PROCESSING_INTERVAL",
          "value": "5"
        }
      ],
      "logConfiguration": {
        "logDriver": "json-file",
        "options": {
          "max-size": "10m",
          "max-file": "3"
        }
      }
    }
  ]
}